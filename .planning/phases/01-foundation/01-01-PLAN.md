---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - bunfig.toml
  - src/index.html
  - src/main.ts
  - .github/workflows/deploy.yml
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "Project builds with `bun run build` command"
    - "Tests run with `bun test` command"
    - "Static site deploys to GitHub Pages on push to main"
  artifacts:
    - path: "package.json"
      provides: "Project manifest with build/test scripts"
      contains: "bun"
    - path: "tsconfig.json"
      provides: "TypeScript configuration for Bun"
      contains: "ESNext"
    - path: "src/index.html"
      provides: "Entry point for static site"
      contains: "<html"
    - path: ".github/workflows/deploy.yml"
      provides: "GitHub Actions deployment workflow"
      contains: "peaceiris/actions-gh-pages"
  key_links:
    - from: "package.json"
      to: "bun build"
      via: "scripts.build"
      pattern: "bun build"
    - from: ".github/workflows/deploy.yml"
      to: "dist/"
      via: "publish_dir"
      pattern: "publish_dir.*dist"
---

<objective>
Set up a Bun-based TypeScript project with build pipeline and GitHub Pages deployment.

Purpose: Establish the foundation for a static site that can be built and deployed automatically, enabling rapid iteration on the bill splitting UI.

Output: Working project that builds with `bun run build` and deploys to GitHub Pages via GitHub Actions.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Bun project with TypeScript</name>
  <files>
    - package.json
    - tsconfig.json
    - bunfig.toml
    - .gitignore
  </files>
  <action>
    Run `bun init` to create package.json, then configure:

    1. Update package.json:
       - Set name to "splits"
       - Add scripts: "build": "bun build ./src/index.html --minify --outdir=dist", "test": "bun test", "dev": "bun build ./src/index.html --outdir=dist --watch"
       - Add devDependency: "@types/bun": "latest"

    2. Create tsconfig.json with Bun's recommended settings from RESEARCH.md:
       - target: ESNext, module: Preserve
       - strict: true, noEmit: true
       - lib: ["ESNext", "DOM"]
       - moduleResolution: bundler

    3. Create bunfig.toml (optional but explicit):
       - [test] section with preload if needed

    4. Update .gitignore:
       - Add: node_modules/, dist/, *.log, .DS_Store

    Run `bun install` to create bun.lockb.
  </action>
  <verify>
    - `cat package.json` shows correct scripts
    - `cat tsconfig.json` shows Bun-compatible config
    - `ls -la` shows bun.lockb exists
  </verify>
  <done>
    - package.json has build, test, dev scripts
    - tsconfig.json configured for Bun
    - bun.lockb created
    - .gitignore includes dist/ and node_modules/
  </done>
</task>

<task type="auto">
  <name>Task 2: Create placeholder source files</name>
  <files>
    - src/index.html
    - src/main.ts
    - src/lib/calculate.ts
  </files>
  <action>
    Create minimal source structure:

    1. src/index.html:
       - Basic HTML5 boilerplate
       - Title: "Split"
       - Script tag referencing ./main.ts (Bun will bundle)
       - Empty div with id="app" for future UI
       - Use relative paths (./main.ts) for subdirectory deployment compatibility

    2. src/main.ts:
       - Import and call a placeholder from calculate.ts
       - console.log to verify it loads

    3. src/lib/calculate.ts:
       - Export placeholder function: `export function calculateBill() { return { message: "TODO" }; }`
       - This will be replaced in Plan 02 with real implementation

    Run `bun run build` to verify build works.
  </action>
  <verify>
    - `bun run build` completes without errors
    - `ls dist/` shows index.html and bundled JS
    - Open dist/index.html in browser, check console for log message
  </verify>
  <done>
    - src/index.html exists with script tag
    - src/main.ts imports from calculate.ts
    - src/lib/calculate.ts has placeholder export
    - `bun run build` produces dist/ with bundled output
  </done>
</task>

<task type="auto">
  <name>Task 3: Set up GitHub Actions deployment</name>
  <files>
    - .github/workflows/deploy.yml
  </files>
  <action>
    Create GitHub Actions workflow for automatic deployment:

    1. Create .github/workflows/deploy.yml:
       - Trigger on push to main branch
       - Use ubuntu-latest runner
       - Set permissions: contents: write (for gh-pages push)
       - Steps:
         a. actions/checkout@v4
         b. oven-sh/setup-bun@v2 with bun-version: latest
         c. bun install --frozen-lockfile
         d. bun test (run tests before deploy)
         e. bun run build
         f. peaceiris/actions-gh-pages@v4 with:
            - github_token: ${{ secrets.GITHUB_TOKEN }}
            - publish_dir: ./dist
            - Only deploy if github.ref == 'refs/heads/main'

    2. Create a placeholder test file so `bun test` doesn't fail:
       - tests/placeholder.test.ts with a single passing test
       - This ensures CI passes before real tests are added

    Note: Actual deployment to tusharc.dev/split will work once:
    - This repo has GitHub Pages enabled (Settings > Pages > Source: gh-pages branch)
    - The main tusharc.dev repo has custom domain configured (which enables subdirectory routing)
  </action>
  <verify>
    - `cat .github/workflows/deploy.yml` shows correct workflow
    - `bun test` passes with placeholder test
    - Workflow syntax is valid (no YAML errors)
  </verify>
  <done>
    - .github/workflows/deploy.yml exists with correct triggers and steps
    - tests/placeholder.test.ts exists and passes
    - Workflow uses peaceiris/actions-gh-pages for deployment
    - CI will run tests before deploying
  </done>
</task>

</tasks>

<verification>
Run these commands to verify the plan is complete:

```bash
# Project structure
ls -la src/ tests/ .github/workflows/

# Build works
bun run build && ls dist/

# Tests pass
bun test

# Scripts defined
cat package.json | grep -A5 '"scripts"'
```
</verification>

<success_criteria>
1. `bun run build` produces dist/index.html and bundled JS
2. `bun test` runs and passes (placeholder test)
3. package.json has build, test, dev scripts
4. tsconfig.json configured for Bun with strict mode
5. .github/workflows/deploy.yml ready to deploy on push to main
6. All source files use relative paths for subdirectory deployment
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
